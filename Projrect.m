clc
%% Scenario Parameters(QBD)
q1=0.5;
q2=0.5;
p1=3/13;
% p2=3/13;
B=[1-p1* (1- q1+ q1* q2), 0, 0, 0;...
    (1-p1)*(q2/2), (1-q2/2)*(1-p1+p1*q1), 0, 0 ;...
    p1*q1*(1-q2)/2, 0,1-p1, 0;...
    0, p1*q1*(1-q2/2)/2, (1-p1)*q2/2, (1-p1)*(1-q2/2)];

A2=[(1-p1)*q1*(1-q2), 0, 0, 0;...
    0, (1-p1)*q1*(1-q2/2), 0, 0;...
    (1-p1)*q1/2*(1-q2), 0, 0, 0;...
    0, (1-p1)*q1/2*(1-q2/2), 0, 0];
A1=[(1-p1)*(1-q1)+p1*q1*(1-q2), 0, 0, (1-p1)*q1*q2;...
    (1-p1)*(1-q1)*q2/2, (1-q2/2)*(1-p1-q1+2*p1*q1), 0, (1-p1)*q1*q2/2;...
    p1*q1/2*(1-q2), 0, (1-p1)*(1-q1/2), (1-p1)*q1/2*q2;...
    0, p1*q1/2*(1-q2/2), (1-p1)*(1-q1/2)*q2/2, (1-p1)*(1-q1/2-q2/2+q1*q2/2)];
A0=[p1*(1-q1), 0, 0, p1*q1*q2;...
    p1*(1-q1)*q2/2, p1*(1-q1)*(1-q2/2), 0, p1*q1*q2/2;...
    0, 0, p1*(1-q1/2), p1*q1/2*q2;...
    0, 0, p1*(1-q1/2)*q2/2, p1*(1-q1/2-q2/2+q1*q2/2)];
A=A1+A2+A0;
alpha=(A^200);
alpha=alpha(1,:);
m=size(A2,1);
mu=alpha*A0*ones(m,1)-alpha*A2*ones(m,1);

%% G calaulation
epsilon=0.000001;
G=GCalculator(A2, A1, A0, epsilon);
U=A1+A0*G;
R=A0*inv(eye(m,m)-U);
%% Stationary State Distribution
% pi_vercor=


