function [B, A2, A1, A0]=TrMatrix(p1, q1, q2)
B=[1-p1* (1- q1+ q1* q2), 0, 0, 0;...
    (1-p1)*(q2/2), (1-q2/2)*(1-p1+p1*q1), 0, 0 ;...
    p1*q1*(1-q2)/2, 0,1-p1, 0;...
    0, p1*q1*(1-q2/2)/2, (1-p1)*q2/2, (1-p1)*(1-q2/2)];

A2=[(1-p1)*q1*(1-q2), 0, 0, 0;...
    0, (1-p1)*q1*(1-q2/2), 0, 0;...
    (1-p1)*q1/2*(1-q2), 0, 0, 0;...
    0, (1-p1)*q1/2*(1-q2/2), 0, 0];
A1=[(1-p1)*(1-q1)+p1*q1*(1-q2), 0, 0, (1-p1)*q1*q2;...
    (1-p1)*(1-q1)*q2/2, (1-q2/2)*(1-p1-q1+2*p1*q1), 0, (1-p1)*q1*q2/2;...
    p1*q1/2*(1-q2), 0, (1-p1)*(1-q1/2), (1-p1)*q1/2*q2;...
    0, p1*q1/2*(1-q2/2), (1-p1)*(1-q1/2)*q2/2, (1-p1)*(1-q1/2-q2/2+q1*q2/2)];
A0=[p1*(1-q1), 0, 0, p1*q1*q2;...
    p1*(1-q1)*q2/2, p1*(1-q1)*(1-q2/2), 0, p1*q1*q2/2;...
    0, 0, p1*(1-q1/2), p1*q1/2*q2;...
    0, 0, p1*(1-q1/2)*q2/2, p1*(1-q1/2-q2/2+q1*q2/2)];





end